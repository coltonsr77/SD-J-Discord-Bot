<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bot Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
    .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); margin-bottom: 20px; }
    h2 { margin-top: 0; }
    .uptodate { color: green; }
    .update { color: red; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Bot Status</h2>
    <p><b>Version:</b> <span id="version"></span></p>
    <p id="updateStatus"></p>
  </div>

  <div class="card">
    <h2>Logs</h2>
    <pre id="logs"></pre>
  </div>

  <script>
    async function loadDashboard() {
      const res = await fetch("/dashboard-data");
      const data = await res.json();

      document.getElementById("version").innerText = data.version;

      if (data.updateInfo.error) {
        document.getElementById("updateStatus").innerText = "Could not fetch updates.";
      } else if (data.updateInfo.upToDate) {
        document.getElementById("updateStatus").innerHTML = `<span class="uptodate">✅ Up-to-date (v${data.version})</span>`;
      } else {
        document.getElementById("updateStatus").innerHTML =
          `<span class="update">⚠️ Update available! Current: v${data.updateInfo.current}, Latest: v${data.updateInfo.latest}</span>
           <br><a href="${data.updateInfo.url}" target="_blank">Get update</a>`;
      }

      document.getElementById("logs").innerText = data.logs.join("\n");
    }

    loadDashboard();
    setInterval(loadDashboard, 5000); // refresh every 5s
  </script>
</body>
</html>
